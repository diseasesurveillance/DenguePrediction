"0","metropolis_hastings_normal <- function(n, sigma_squared) {"
"0","  x <- numeric(n)"
"0","  x[1] <- rnorm(1)"
"0","  "
"0","  for (i in 2:n) {"
"0","    x_proposed <- rnorm(1, mean = x[i-1], sd = sqrt(sigma_squared))"
"0","    alpha <- min(1, dnorm(x_proposed) / dnorm(x[i-1]))"
"0","    "
"0","    if (runif(1) < alpha) {"
"0","      x[i] <- x_proposed"
"0","    } else {"
"0","      x[i] <- x[i-1]"
"0","    }"
"0","  }"
"0","  return(x)"
"0","}"
"0",""
"0","n <- 10000"
"0","sigmas_squared <- c(0.15^2, 1, 2.4^2, 5^2)"
"0",""
"0","results <- lapply(sigmas_squared, function(sigma_squared) {"
"0","  metropolis_hastings_normal(n, sigma_squared)"
"0","})"
"0",""
"0","par(mfrow = c(2, 2))"
"0","for (i in 1:length(results)) {"
"0","  hist(results[[i]], main = paste(""Sigma^2 ="", sigmas_squared[i]), xlab = ""Value"", prob = TRUE)"
"0","  lines(density(results[[i]]), col = ""blue"")"
"0","}"
